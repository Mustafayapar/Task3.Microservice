{
  "ReverseProxy": {
    "Routes": {
      "auth-route": {
        "ClusterId": "auth-cluster",
        "Match": { "Path": "/auth/{**catch-all}" },
        "Transforms": [
          { "PathRemovePrefix": "/auth" },
          { "RequestHeadersCopy": "true" },
          { "X-Forwarded": "proto,host,for" }
        ],
        "AuthorizationPolicy": "JwtOptional", // login/register anon, diğerleri doğrulanabilir
        "RateLimiterPolicy": "per-ip-burst"
      },
      "products-route": {
        "ClusterId": "products-cluster",
        "Match": { "Path": "/products/{**catch-all}" },
        "Transforms": [
          { "PathRemovePrefix": "/products" },
          { "RequestHeadersCopy": "true" },
          { "X-Forwarded": "proto,host,for" }
        ],
        "AuthorizationPolicy": "JwtRequired", // ürün update vs. koruma
        "RateLimiterPolicy": "per-ip-burst"
      },
      "logs-route": {
        "ClusterId": "logs-cluster",
        "Match": { "Path": "/logs/{**catch-all}" },
        "Transforms": [
          { "PathRemovePrefix": "/logs" },
          { "RequestHeadersCopy": "true" },
          { "X-Forwarded": "proto,host,for" }
        ],
        "AuthorizationPolicy": "JwtRequired",
        "RateLimiterPolicy": "per-ip-strict"
      }
    },
    "Clusters": {
      "authCluster": {
        "Destinations": {
          "authApi": { "Address": "http://localhost:5037" }
        }
      },
      "productCluster": {
        "Destinations": {
          "productApi": { "Address": "http://localhost:5038" }
        }
      },
      "logCluster": {
        "Destinations": {
          "logApi": { "Address": "http://localhost:5039" }
        }
      }
    }
  },

  "IpRateLimiting": {
    "EnableEndpointRateLimiting": true,
    "StackBlockedRequests": false,
    "RealIpHeader": "X-Real-IP",
    "ClientIdHeader": "X-ClientId",
    "GeneralRules": [
      {
        "Endpoint": "*",
        "Period": "1s",
        "Limit": 5
      }
    ]
  },

  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*"
}
